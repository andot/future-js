function TimeoutError(t){Error.call(this),this.message=t,this.name=TimeoutError.name,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,TimeoutError)}TimeoutError.prototype=Object.create(Error.prototype),TimeoutError.prototype.constructor=TimeoutError,Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice,n=e.call(arguments,1),r=this,u=function(){},i=function(){return r.apply(this instanceof u?this:t,n.concat(e.call(arguments)))};return this.prototype&&(u.prototype=this.prototype),i.prototype=new u,i}),function(t,e){"use strict";function n(t){var e=this;Object.defineProperties(e,{_subscribers:{value:[]},resolve:{value:this.resolve.bind(e)},reject:{value:this.reject.bind(e)}}),"function"==typeof t&&U(function(){try{e.resolve(t())}catch(t){e.reject(t)}})}function r(t){return t instanceof n}function u(t){return"function"==typeof t.then}function i(t,e){var r="function"==typeof e?e:function(){return e},u=new n;return setTimeout(function(){try{u.resolve(r())}catch(t){u.reject(t)}},t),u}function o(t){var e=new n;return e.reject(t),e}function c(t){var e=new n;return e.resolve(t),e}function a(t){try{var e=t();return c(e)}catch(t){return o(t)}}function f(t){var e=new n;return t(e.resolve,e.reject),e}function l(t){var e=0;return V.call(t,function(){++e}),e}function s(t){return t=u(t)?t:c(t),t.then(function(t){var e=t.length,r=l(t),u=new Array(e);if(0===r)return c(u);var i=new n;return V.call(t,function(t,e){x(t).then(function(t){u[e]=t,0===--r&&i.resolve(u)},i.reject)}),i})}function h(){return s(arguments)}function v(t){return t=u(t)?t:c(t),t.then(function(t){var e=new n;return V.call(t,function(t){x(t).fill(e)}),e})}function p(t){return t=u(t)?t:c(t),t.then(function(t){var e=t.length,r=l(t);if(0===r)throw new RangeError("any(): array must not be empty");var u=new Array(e),i=new n;return V.call(t,function(t,e){x(t).then(i.resolve,function(t){u[e]=t,0===--r&&i.reject(u)})}),i})}function y(t){return t=u(t)?t:c(t),t.then(function(t){var e=t.length,r=l(t),u=new Array(e);if(0===r)return c(u);var i=new n;return V.call(t,function(t,e){var n=x(t);n.whenComplete(function(){u[e]=n.inspect(),0===--r&&i.resolve(u)})}),i})}function d(t){var e=function(){return this}(),n=W.call(arguments,1);return s(n).then(function(n){return t.apply(e,n)})}function m(t,e){var n=W.call(arguments,2);return s(n).then(function(n){return t.apply(e,n)})}function w(t){return!!t&&("function"==typeof t.next&&"function"==typeof t.throw)}function j(t){if(!t)return!1;var e=t.constructor;return!!e&&("GeneratorFunction"===e.name||"GeneratorFunction"===e.displayName||w(e.prototype))}function b(t){return function(n,r){return n instanceof Error?t.reject(n):arguments.length<2?t.resolve(n):(r=null===n||n===e?W.call(arguments,1):W.call(arguments,0),void(1==r.length?t.resolve(r[0]):t.resolve(r)))}}function g(t){if(j(t)||w(t))return T(t);var e=function(){return this}(),r=new n;return t.call(e,b(r)),r}function E(t){return function(){var e=W.call(arguments,0),r=this,u=new n;e.push(function(){r=this,u.resolve(arguments)});try{t.apply(this,e)}catch(t){u.resolve([t])}return function(t){u.then(function(e){t.apply(r,e)})}}}function _(t){return function(){var e=W.call(arguments,0),r=new n;e.push(b(r));try{t.apply(this,e)}catch(t){r.reject(t)}return r}}function x(t){return t?u(t)?t:j(t)||w(t)?T(t):c(t):c(t)}function T(t){function e(e){try{u(t.next(e))}catch(t){c.reject(t)}}function r(e){try{u(t.throw(e))}catch(t){return c.reject(t)}}function u(t){t.done?c.resolve(t.value):("function"==typeof t.value?g(t.value):x(t.value)).then(e,r)}var i=function(){return this}();if("function"==typeof t){var o=W.call(arguments,1);t=t.apply(i,o)}var c=new n;return t&&"function"==typeof t.next?(e(),c):c.resolve(t)}function O(t,e){return function(){return e=e||this,s(arguments).then(function(n){var r=t.apply(e,n);return j(r)||w(r)?T.call(e,r):r})}}function P(t,e,n){return n=n||function(){return this}(),s(t).then(function(t){return t.forEach(e,n)})}function F(t,e,n){return n=n||function(){return this}(),s(t).then(function(t){return t.every(e,n)})}function A(t,e,n){return n=n||function(){return this}(),s(t).then(function(t){return t.some(e,n)})}function I(t,e,n){return n=n||function(){return this}(),s(t).then(function(t){return t.filter(e,n)})}function R(t,e,n){return n=n||function(){return this}(),s(t).then(function(t){return t.map(e,n)})}function k(t,e,n){return arguments.length>2?s(t).then(function(t){return u(n)||(n=c(n)),n.then(function(n){return t.reduce(e,n)})}):s(t).then(function(t){return t.reduce(e)})}function S(t,e,n){return arguments.length>2?s(t).then(function(t){return u(n)||(n=c(n)),n.then(function(n){return t.reduceRight(e,n)})}):s(t).then(function(t){return t.reduceRight(e)})}function C(t,e,n){return s(t).then(function(t){return u(e)||(e=c(e)),e.then(function(e){return t.indexOf(e,n)})})}function G(t,n,r){return s(t).then(function(t){return u(n)||(n=c(n)),n.then(function(n){return r===e&&(r=t.length-1),t.lastIndexOf(n,r)})})}function N(t,e,n){return s(t).then(function(t){return u(e)||(e=c(e)),e.then(function(e){return t.includes(e,n)})})}function q(t,e,n){return n=n||function(){return this}(),s(t).then(function(t){return t.find(e,n)})}function z(t,e,n){return n=n||function(){return this}(),s(t).then(function(t){return t.findIndex(e,n)})}function B(t,e,n){U(function(){try{var r=t(n);e.resolve(r)}catch(t){e.reject(t)}})}function D(t,e,n){t?B(t,e,n):e.resolve(n)}function H(t,e,n){t?B(t,e,n):e.reject(n)}function J(t){n.call(this),t(this.resolve,this.reject)}var K=0,L=1,M=2,Q="undefined"!=typeof t.process&&"[object process]"===Object.prototype.toString.call(t.process)&&!t.process.browser,U="function"==typeof t.setImmediate?t.setImmediate:Q?t.process.nextTick:function(t){setTimeout(t,0)},V=Array.prototype.forEach,W=Array.prototype.slice;return T.wrap=O,Object.defineProperties(n,{delayed:{value:i},error:{value:o},sync:{value:a},value:{value:c},all:{value:s},race:{value:v},resolve:{value:c},reject:{value:o},promise:{value:f},isFuture:{value:r},isPromise:{value:u},toPromise:{value:x},join:{value:h},any:{value:p},settle:{value:y},attempt:{value:d},run:{value:m},thunkify:{value:E},promisify:{value:_},co:{value:T},wrap:{value:O},forEach:{value:P},every:{value:F},some:{value:A},filter:{value:I},map:{value:R},reduce:{value:k},reduceRight:{value:S},indexOf:{value:C},lastIndexOf:{value:G},includes:{value:N},find:{value:q},findIndex:{value:z}}),Object.defineProperties(n.prototype,{_value:{writable:!0},_reason:{writable:!0},_state:{value:K,writable:!0},resolve:{value:function(t){if(t===this)return void this.reject(new TypeError("Self resolution"));if(r(t))return void t.fill(this);if(null!==t&&"object"==typeof t||"function"==typeof t){var e;try{e=t.then}catch(t){return void this.reject(t)}if("function"==typeof e){var n=!0;try{var u=this;return void e.call(t,function(t){n&&(n=!1,u.resolve(t))},function(t){n&&(n=!1,u.reject(t))})}catch(t){n&&(n=!1,this.reject(t))}return}}if(this._state===K){this._state=L,this._value=t;for(var i=this._subscribers;i.length>0;){var o=i.shift();D(o.onfulfill,o.next,t)}}}},reject:{value:function(t){if(this._state===K){this._state=M,this._reason=t;for(var e=this._subscribers;e.length>0;){var n=e.shift();H(n.onreject,n.next,t)}}}},then:{value:function(t,e){"function"!=typeof t&&(t=null),"function"!=typeof e&&(e=null);var r=new n;return this._state===L?D(t,r,this._value):this._state===M?H(e,r,this._reason):this._subscribers.push({onfulfill:t,onreject:e,next:r}),r}},done:{value:function(t,e){this.then(t,e).then(null,function(t){U(function(){throw t})})}},inspect:{value:function(){switch(this._state){case K:return{state:"pending"};case L:return{state:"fulfilled",value:this._value};case M:return{state:"rejected",reason:this._reason}}}},catchError:{value:function(t,e){if("function"==typeof e){var n=this;return this.catch(function(r){if(e(r))return n.catch(t);throw r})}return this.catch(t)}},catch:{value:function(t){return this.then(null,t)}},fail:{value:function(t){this.done(null,t)}},whenComplete:{value:function(t){return this.then(function(e){return t(),e},function(e){throw t(),e})}},complete:{value:function(t){return t=t||function(t){return t},this.then(t,t)}},always:{value:function(t){this.done(t,t)}},fill:{value:function(t){this.then(t.resolve,t.reject)}},timeout:{value:function(t,e){var r=new n,u=setTimeout(function(){r.reject(e||new TimeoutError("timeout"))},t);return this.whenComplete(function(){clearTimeout(u)}).fill(r),r}},delay:{value:function(t){var e=new n;return this.then(function(n){setTimeout(function(){e.resolve(n)},t)},e.reject),e}},tap:{value:function(t,e){return this.then(function(n){return t.call(e,n),n})}},spread:{value:function(t,e){return this.then(function(n){return t.apply(e,n)})}},get:{value:function(t){return this.then(function(e){return e[t]})}},set:{value:function(t,e){return this.then(function(n){return n[t]=e,n})}},apply:{value:function(t,e){return e=e||[],this.then(function(n){return s(e).then(function(e){return n[t].apply(n,e)})})}},call:{value:function(t){var e=W.call(arguments,1);return this.then(function(n){return s(e).then(function(e){return n[t].apply(n,e)})})}},bind:{value:function(t){var e=W.call(arguments);{if(!Array.isArray(t)){e.shift();var n=this;return Object.defineProperty(this,t,{value:function(){var r=W.call(arguments);return n.then(function(n){return s(e.concat(r)).then(function(e){return n[t].apply(n,e)})})}}),this}for(var r=0,u=t.length;r<u;++r)e[0]=t[r],this.bind.apply(this,e)}}},forEach:{value:function(t,e){return P(this,t,e)}},every:{value:function(t,e){return F(this,t,e)}},some:{value:function(t,e){return A(this,t,e)}},filter:{value:function(t,e){return I(this,t,e)}},map:{value:function(t,e){return R(this,t,e)}},reduce:{value:function(t,e){return arguments.length>1?k(this,t,e):k(this,t)}},reduceRight:{value:function(t,e){return arguments.length>1?S(this,t,e):S(this,t)}},indexOf:{value:function(t,e){return C(this,t,e)}},lastIndexOf:{value:function(t,e){return G(this,t,e)}},includes:{value:function(t,e){return N(this,t,e)}},find:{value:function(t,e){return q(this,t,e)}},findIndex:{value:function(t,e){return z(this,t,e)}}}),n.deferred=function(){var t=new n;return Object.create(null,{promise:{value:t},resolve:{value:t.resolve},reject:{value:t.reject}})},t.Future=n,"function"==typeof define&&(define.cmd?define("Future",[],n):define.amd&&define("Future",[],function(){return n})),"object"==typeof module&&(module.exports=n),"function"==typeof Promise?void(t.Promise=Promise):(J.prototype=Object.create(n.prototype),J.prototype.constructor=n,Object.defineProperties(J,{all:{value:s},race:{value:v},resolve:{value:c},reject:{value:o}}),void(t.Promise=J))}("object"==typeof global?global:"object"==typeof window?window:"object"==typeof self?self:this);